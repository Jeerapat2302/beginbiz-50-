<script lang="ts">
	import { ChevronsUp, Search } from "lucide-svelte";
	import { scrollTo, scrollTop, scrollRef } from "svelte-scrolling";
	import { fade } from "svelte/transition";
	import Typewriter from "svelte-typewriter";
	import laws from "$lib/assets/laws.jpg";
	import chat_img from "$lib/assets/Chat.jpg";
	import docs from "$lib/assets/Docs.jpg";
	import { flip } from "svelte/animate";

	let scrollY: number;

	function wait(ms: number) {
		return new Promise((resolve) => {
			setTimeout(resolve, ms);
		});
	}

	$: cardData = [
		{
			id: 1,
			image: laws,
			image_alt: "info",
			header: "üìÑ ‡∏ö‡∏≠‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢",
			sub_header:
				"‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏≤‡∏Å‡∏≠‡∏µ‡∏Å‡∏ï‡πà‡∏≠‡πÑ‡∏õ ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏î‡∏π‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£",
			information: {
				features: [
					"00",
					"01",
				],
			},
			link: "/",
			card_color: "pink",
			state: true,
			show_image: true,
		},
		{
			id: 2,
			image: chat_img,
			image_alt: "info",
			header: "üîé ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô",
			sub_header: "Chatbot ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏è‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏ó‡∏¢",
			information: {
				features: [
					"01",
					"02",
				],
			},
			link: "/chat",
			card_color: "accent",
			state: false,
			show_image: false,
		},
		{
			id: 3,
			image: docs,
			image_alt: "",
			header: "üí¨ ‡∏ö‡∏¥‡∏™‡∏Å‡∏¥‡∏ó‡∏ã‡πå‡πÅ‡∏ä‡∏ï‡∏ö‡∏≠‡∏ï‡∏ô‡πâ‡∏≠‡∏¢‡∏Ñ‡∏≠‡∏¢‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°",
			sub_header: "‡πÅ‡∏ä‡∏ï‡∏ö‡∏≠‡∏ï‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏Ñ‡∏≠‡∏¢‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏á‡∏™‡∏±‡∏¢",
			information: {
				features: [
					"‡πÅ‡∏ä‡∏ï‡∏ö‡∏≠‡∏ï‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏û‡∏¥‡∏°‡∏û‡πå",
					"‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô",
					"‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Å‡∏è‡∏´‡∏°‡∏≤‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à",
				],
			},
			link: "/documents",
			card_color: "success",
			state: false,
			show_image: false,
		},
	];
	let isOpen = 0;
	$: {
		isOpen = 0;
		if (!cardData[0].state && cardData[1].state && !cardData[2].state) {
			isOpen = 2;
		} else {
			for (let i = 0; i < cardData.length; i++) {
				if (cardData[i].state) {
					isOpen++;
				}
			}
		}
	}
</script>

<svelte:window bind:scrollY />

<section use:scrollRef={"services"} />
<div class={"flex flex-col justify-center items-center text-center px-4 lg:px-36 w-full pb-10"}>
	<div class="grid max-w-lg lg:max-w-4xl grid-flow-row lg:grid-cols-6 mt-10 gap-4">
		{#each cardData as data (data.id)}
			<div animate:flip={{ duration: 500 }} class:lg:col-span-6={data.state} class={`col-span-${6 / (3 - isOpen)}`}>
				<div class={`card ${data.state ? "lg:card-side" : ""} 
                    w-full h-full bg-${data.card_color }/5 border border-${data.card_color}/50`}>
					{#if data.state}
						<img
							src={data.image}
							alt={data.image_alt}
							class={`m-6 lg:m-10 rounded-xl object-cover max-w-full transition-[height_blur_opacity] duration-500 ${
								data.show_image ? "h-full lg:h-96" : "h-0 blur-sm opacity-0"
							}`}
						/>
					{/if}

					<div class="card-body items-center text-center">
						<h2 class="card-title">{data.header}</h2>
						<p>
							{data.sub_header}
							{#if data.show_image}
								<div
									class={`collapse collapse-arrow border border-1 border-black/30 mt-4 text-left`}
									in:fade={{ delay: 250, duration: 250 }}
									out:fade={{ duration: 100 }}
								>
									<input
										type="radio"
										name={`my-accordion-${data.id}`}
										checked
									/>
									<div class="collapse-title text-lg font-bold">‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå ‚úÖ</div>
									<div class="collapse-content space-y-4">
										{#each data.information.features as feature}
											<p>{feature}</p>
										{/each}
									</div>
								</div>
								<div
									class={`collapse collapse-arrow border border-1 border-black/30 mt-2 text-left`}
									in:fade={{ delay: 500, duration: 250 }}
									out:fade={{ duration: 100 }}
								>
								</div>
							{/if}
						</p>

						<div class="card-actions my-4 justify-center">
							<a href={data.link}
								><button
									class="btn btn-sm lg:rounded-l-full btn-{data.card_color}"
									>‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ</button
								></a
							>
							<button
								class={`btn btn-sm no-underline lg:rounded-r-full btn-outline btn-${data.card_color}`}
								on:click={async () => {
									if (!data.state) {
										data.state = true;
										if (isOpen < 2) {
											await wait(250);
										}
										data.show_image = true;
									} else {
										data.show_image = false;
										await wait(250);
										data.state = false;
									}
									// await toggleStateById(data.id);
								}}>{data.state ? "‡∏õ‡∏¥‡∏î" : "‡∏î‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"}</button
							>
						</div>
					</div>
				</div>
			</div>
		{/each}
	</div>
		</div>


<style>
	.blob1 {
		position: fixed;
		top: 50%;
		left: 0%;

		width: 70vw;
		height: 70vw;
		background: radial-gradient(
			circle at 50% 50%,
			#d769af33 0%,
			transparent 70%
		);
		transform: translate(-50%, -50%);
		z-index: -50;
		animation: gradientAnimation 5s infinite alternate;
	}
	.blob2 {
		position: fixed;
		top: 0%;
		left: 100%;

		width: 70vw;
		height: 70vw;
		background: radial-gradient(
			circle at 50% 50%,
			#8290ec38 0%,
			transparent 70%
		);
		transform: translate(-50%, -50%);
		z-index: -50;
	}
	.animateFromTop {
		opacity: 0; /* Set initial opacity to 0 */
		transform: translateY(
			-40px
		); /* Move the element 100px above its normal position */

		/* Apply animation properties */
		animation: fadeInFromTop 0.5s ease-out forwards;
	}

	/* Define the keyframes for the animation */
	@keyframes fadeInFromTop {
		from {
			opacity: 0;
			transform: translateY(-40px);
		}

		to {
			opacity: 1;
			transform: translateY(0);
		}
	}
</style>
